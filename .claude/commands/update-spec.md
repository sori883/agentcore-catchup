---
description: 仕様書・アーキテクチャ・変更履歴を更新する。機能追加・変更後に必ず実行。
---

# 仕様書更新コマンド

コード変更後にドキュメントを更新するコマンドです。

## 使用方法

```
/update-spec [更新対象]
```

### 更新対象

| 対象 | 説明 |
|------|------|
| `feature` | 機能追加・変更時（SPEC.md + CHANGELOG.md） |
| `arch` | アーキテクチャ変更時（ARCHITECTURE.md + CHANGELOG.md） |
| `all` | 全ドキュメントを更新 |

### 使用例

```
/update-spec feature    # 機能追加後
/update-spec arch       # アーキテクチャ変更後
/update-spec all        # 全ドキュメント更新
```

## 実行手順

### 1. 変更内容の収集

```bash
# 最新のコミット履歴を確認
git log --oneline -10

# 変更されたファイルを確認
git diff --name-only HEAD~5

# 関連するIssue/PRを確認
gh issue list --state closed --limit 10
```

### 2. ソースコードの分析

変更されたファイルから以下を抽出：

- **新規追加された機能**
  - 新しいモジュール、関数、構造体
  - 新しいキーバインド、コマンド

- **変更された機能**
  - 動作変更
  - インターフェース変更

- **削除された機能**
  - 非推奨・削除された機能

### 3. SPEC.md の更新

```markdown
## 機能一覧テーブルを更新
| 機能名 | 説明 | ステータス |
|--------|------|-----------|
| 新機能 | 説明 | ✅ 実装済み |

## 機能詳細セクションを追加/更新
### N. 新機能名

#### 概要
機能の説明

#### 仕様
- 詳細な動作仕様
- キーバインド（あれば）

#### 関連ファイル
- `src/xxx.rs` - 説明
```

### 4. ARCHITECTURE.md の更新（アーキテクチャ変更時）

```markdown
## ディレクトリ構成を更新
新しいモジュール/ファイルを追加

## 技術スタックを更新
新しい依存クレートを追加

## システム構成図を更新
新しいコンポーネントを追加
```

### 5. CHANGELOG.md の更新

```markdown
## [Unreleased]

### 追加
- 新機能の説明 (#Issue番号)

### 変更
- 変更内容の説明 (#Issue番号)

### 修正
- バグ修正の説明 (#Issue番号)
```

### 6. 更新内容の確認

```bash
# 変更されたドキュメントを確認
git diff docs/

# 差分を表示
git diff --stat docs/
```

## 更新チェックリスト

### 機能追加時
- [ ] SPEC.md の機能一覧テーブルに追加
- [ ] SPEC.md の機能詳細セクションに追加
- [ ] CHANGELOG.md の「追加」セクションに記録
- [ ] 関連ファイルのパスを記載

### アーキテクチャ変更時
- [ ] ARCHITECTURE.md のディレクトリ構成を更新
- [ ] ARCHITECTURE.md の技術スタックを更新（依存追加時）
- [ ] ARCHITECTURE.md のシステム構成図を更新
- [ ] CHANGELOG.md に記録

### リリース時
- [ ] CHANGELOG.md の [Unreleased] を新バージョンに変更
- [ ] バージョン番号を更新
- [ ] リリース日を追加

## 注意事項

- ドキュメントは日本語で記述
- Issue番号を必ず記載（`#123`形式）
- 関連ファイルのパスは正確に記載
- 未実装機能は「🔲 未実装」、実装済みは「✅ 実装済み」

## 関連コマンド

- `/docs` - ドキュメント参照
- `/create-issue` - Issue作成
